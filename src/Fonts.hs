{-# LANGUAGE LambdaCase #-}

module Fonts (module Fonts) where

import Data.Map (Map, fromList, (!?))

-- | all unicode fonts
data Font = Sup | Sub | Bold | Italic | Cal | Frak | BB | SF | TT | Scr deriving (Show, Eq)

getFontMap :: Font -> Map Char Char
getFontMap = \case
  Sup -> supMap
  Sub -> subMap
  Bold -> boldMap
  Italic -> italicMap
  Cal -> calMap
  Frak -> frakMap
  BB -> bbMap
  SF -> sfMap
  TT -> ttMap
  Scr -> scrMap

-- | Convert a font into a latex command
--
-- For example `Sup` will be converted to `"^"`
-- and `Cal` will be converted to `"\mathcal"`.
--
-- we will convert the font to math font, instead of text font,
-- given the use case of converting documents using unicode-latex.
-- this can be subject to change if there are other use cases.
getCommandPrefix :: Font -> String
getCommandPrefix = \case
  Sup -> "^"
  Sub -> "_"
  Bold -> "\\mathbf"
  Italic -> "\\mathit"
  Cal -> "\\mathcal"
  Frak -> "\\mathfrak"
  BB -> "\\mathbb"
  SF -> "\\mathsf"
  TT -> "\\mathtt"
  Scr -> "\\mathscr"

-- | Convert a unicode string of a specific font to ascii
convertFont :: Font -> String -> String
convertFont font uniStr =
  let fontMap = getFontMap font
      prefix = getCommandPrefix font
   in case mapM (fontMap !?) uniStr of
        Just converted -> prefix ++ "{" ++ converted ++ "}"
        Nothing -> error "Internal Error, this is a bug, please consider reporting it: cannot convert some element in \"" ++ uniStr ++ "\""

supMap :: Map Char Char
supMap =
  fromList
    [ ('â°', '0'),
      ('â±', 'i'),
      ('Â¹', '1'),
      ('Â²', '2'),
      ('Â³', '3'),
      ('â´', '4'),
      ('âµ', '5'),
      ('â¶', '6'),
      ('â·', '7'),
      ('â¸', '8'),
      ('â¹', '9'),
      ('âº', '+'),
      ('â»', '-'),
      ('â¼', '='),
      ('â½', '('),
      ('â¾', ')'),
      ('áµƒ', 'a'),
      ('áµ‡', 'b'),
      ('á¶œ', 'c'),
      ('áµˆ', 'd'),
      ('áµ‰', 'e'),
      ('á¶ ', 'f'),
      ('áµ', 'g'),
      ('Ê°', 'h'),
      ('â±', 'i'),
      ('Ê²', 'j'),
      ('áµ', 'k'),
      ('Ë¡', 'l'),
      ('áµ', 'm'),
      ('â¿', 'n'),
      ('áµ’', 'o'),
      ('áµ–', 'p'),
      ('ğ¥', 'q'),
      ('Ê³', 'r'),
      ('Ë¢', 's'),
      ('áµ—', 't'),
      ('áµ˜', 'u'),
      ('áµ›', 'v'),
      ('â±½', 'v'),
      ('Ê·', 'w'),
      ('Ë£', 'x'),
      ('Ê¸', 'y'),
      ('á¶»', 'z'),
      ('á´¬', 'A'),
      ('á´®', 'B'),
      ('êŸ²', 'C'),
      ('á´°', 'D'),
      ('á´±', 'E'),
      ('êŸ³', 'F'),
      ('á´³', 'G'),
      ('á´´', 'H'),
      ('á´µ', 'I'),
      ('á´¶', 'J'),
      ('á´·', 'K'),
      ('á´¸', 'L'),
      ('á´¹', 'M'),
      ('á´º', 'N'),
      ('á´¼', 'O'),
      ('á´¾', 'P'),
      ('êŸ´', 'Q'),
      ('á´¿', 'R'),
      ('áµ€', 'T'),
      ('áµ', 'U'),
      ('â±½', 'V'),
      ('áµ‚', 'W')
    ]

subMap :: Map Char Char
subMap =
  fromList
    [ ('â‚€', '0'),
      ('â‚', '1'),
      ('â‚‚', '2'),
      ('â‚ƒ', '3'),
      ('â‚„', '4'),
      ('â‚…', '5'),
      ('â‚†', '6'),
      ('â‚‡', '7'),
      ('â‚ˆ', '8'),
      ('â‚‰', '9'),
      ('â‚Š', '+'),
      ('â‚‹', '-'),
      ('â‚Œ', '='),
      ('â‚', '('),
      ('â‚', ')'),
      ('â‚', 'a'),
      ('â‚‘', 'e'),
      ('â‚•', 'h'),
      ('áµ¢', 'i'),
      ('â±¼', 'j'),
      ('â‚–', 'k'),
      ('â‚—', 'l'),
      ('â‚˜', 'm'),
      ('â‚™', 'n'),
      ('â‚’', 'o'),
      ('â‚š', 'p'),
      ('áµ£', 'r'),
      ('â‚›', 's'),
      ('â‚œ', 't'),
      ('áµ¤', 'u'),
      ('áµ¥', 'v'),
      ('â‚“', 'x')
    ]

boldMap :: Map Char Char
boldMap =
  fromList
    [ ('ğ€', 'A'),
      ('ğ', 'B'),
      ('ğ‚', 'C'),
      ('ğƒ', 'D'),
      ('ğ„', 'E'),
      ('ğ…', 'F'),
      ('ğ†', 'G'),
      ('ğ‡', 'H'),
      ('ğˆ', 'I'),
      ('ğ‰', 'J'),
      ('ğŠ', 'K'),
      ('ğ‹', 'L'),
      ('ğŒ', 'M'),
      ('ğ', 'N'),
      ('ğ', 'O'),
      ('ğ', 'P'),
      ('ğ', 'Q'),
      ('ğ‘', 'R'),
      ('ğ’', 'S'),
      ('ğ“', 'T'),
      ('ğ”', 'U'),
      ('ğ•', 'V'),
      ('ğ–', 'W'),
      ('ğ—', 'X'),
      ('ğ˜', 'Y'),
      ('ğ™', 'Z'),
      ('ğš', 'a'),
      ('ğ›', 'b'),
      ('ğœ', 'c'),
      ('ğ', 'd'),
      ('ğ', 'e'),
      ('ğŸ', 'f'),
      ('ğ ', 'g'),
      ('ğ¡', 'h'),
      ('ğ¢', 'i'),
      ('ğ£', 'j'),
      ('ğ¤', 'k'),
      ('ğ¥', 'l'),
      ('ğ¦', 'm'),
      ('ğ§', 'n'),
      ('ğ¨', 'o'),
      ('ğ©', 'p'),
      ('ğª', 'q'),
      ('ğ«', 'r'),
      ('ğ¬', 's'),
      ('ğ­', 't'),
      ('ğ®', 'u'),
      ('ğ¯', 'v'),
      ('ğ°', 'w'),
      ('ğ±', 'x'),
      ('ğ²', 'y'),
      ('ğ³', 'z'),
      ('ğŸ', '0'),
      ('ğŸ', '1'),
      ('ğŸ', '2'),
      ('ğŸ‘', '3'),
      ('ğŸ’', '4'),
      ('ğŸ“', '5'),
      ('ğŸ”', '6'),
      ('ğŸ•', '7'),
      ('ğŸ–', '8'),
      ('ğŸ—', '9')
    ]

italicMap :: Map Char Char
italicMap =
  fromList
    [ ('ğ´', 'A'),
      ('ğµ', 'B'),
      ('ğ¶', 'C'),
      ('ğ·', 'D'),
      ('ğ¸', 'E'),
      ('ğ¹', 'F'),
      ('ğº', 'G'),
      ('ğ»', 'H'),
      ('ğ¼', 'I'),
      ('ğ½', 'J'),
      ('ğ¾', 'K'),
      ('ğ¿', 'L'),
      ('ğ‘€', 'M'),
      ('ğ‘', 'N'),
      ('ğ‘‚', 'O'),
      ('ğ‘ƒ', 'P'),
      ('ğ‘„', 'Q'),
      ('ğ‘…', 'R'),
      ('ğ‘†', 'S'),
      ('ğ‘‡', 'T'),
      ('ğ‘ˆ', 'U'),
      ('ğ‘‰', 'V'),
      ('ğ‘Š', 'W'),
      ('ğ‘‹', 'X'),
      ('ğ‘Œ', 'Y'),
      ('ğ‘', 'Z'),
      ('ğ‘', 'a'),
      ('ğ‘', 'b'),
      ('ğ‘', 'c'),
      ('ğ‘‘', 'd'),
      ('ğ‘’', 'e'),
      ('ğ‘“', 'f'),
      ('ğ‘”', 'g'),
      ('ğ‘–', 'i'),
      ('ğ‘—', 'j'),
      ('ğ‘˜', 'k'),
      ('ğ‘™', 'l'),
      ('ğ‘š', 'm'),
      ('ğ‘›', 'n'),
      ('ğ‘œ', 'o'),
      ('ğ‘', 'p'),
      ('ğ‘', 'q'),
      ('ğ‘Ÿ', 'r'),
      ('ğ‘ ', 's'),
      ('ğ‘¡', 't'),
      ('ğ‘¢', 'u'),
      ('ğ‘£', 'v'),
      ('ğ‘¤', 'w'),
      ('ğ‘¥', 'x'),
      ('ğ‘¦', 'y'),
      ('ğ‘§', 'z')
    ]

calMap :: Map Char Char
calMap =
  fromList
    [ ('â„°', 'E'),
      ('â„±', 'F'),
      ('â„Š', 'g'),
      ('â„‹', 'H'),
      ('â„', 'I'),
      ('â„’', 'L'),
      ('â„³', 'M'),
      ('â„›', 'R'),
      ('â„¬', 'B'),
      ('ğ’œ', 'A'),
      ('ğ’', 'C'),
      ('ğ’Ÿ', 'D'),
      ('ğ’¢', 'G'),
      ('ğ’¥', 'J'),
      ('ğ’¦', 'K'),
      ('ğ’©', 'N'),
      ('ğ’ª', 'O'),
      ('ğ’«', 'P'),
      ('ğ’¬', 'Q'),
      ('ğ’®', 'S'),
      ('ğ’¯', 'T'),
      ('ğ’°', 'U'),
      ('ğ’±', 'V'),
      ('ğ’²', 'W'),
      ('ğ’³', 'X'),
      ('ğ’´', 'Y'),
      ('ğ’µ', 'Z'),
      ('ğ’¶', 'a'),
      ('ğ’·', 'b'),
      ('ğ’¸', 'c'),
      ('ğ’¹', 'd'),
      ('ğ’»', 'f'),
      ('ğ’½', 'h'),
      ('ğ’¾', 'i'),
      ('ğ’¿', 'j'),
      ('ğ“€', 'k'),
      ('ğ“', 'l'),
      ('ğ“‚', 'm'),
      ('ğ“ƒ', 'n'),
      ('ğ“…', 'p'),
      ('ğ“†', 'q'),
      ('ğ“‡', 'r'),
      ('ğ“ˆ', 's'),
      ('ğ“‰', 't'),
      ('ğ“Š', 'u'),
      ('ğ“‹', 'v'),
      ('ğ“Œ', 'w'),
      ('ğ“', 'x'),
      ('ğ“', 'y'),
      ('ğ“', 'z')
    ]

frakMap :: Map Char Char
frakMap =
  fromList
    [ ('â„Œ', 'H'),
      ('â„œ', 'R'),
      ('â„­', 'C'),
      ('â„¨', 'Z'),
      ('ğ”„', 'A'),
      ('ğ”…', 'B'),
      ('ğ”‡', 'D'),
      ('ğ”ˆ', 'E'),
      ('ğ”‰', 'F'),
      ('ğ”Š', 'G'),
      ('ğ”', 'J'),
      ('ğ”', 'K'),
      ('ğ”', 'L'),
      ('ğ”', 'M'),
      ('ğ”‘', 'N'),
      ('ğ”’', 'O'),
      ('ğ”“', 'P'),
      ('ğ””', 'Q'),
      ('ğ”–', 'S'),
      ('ğ”—', 'T'),
      ('ğ”˜', 'U'),
      ('ğ”™', 'V'),
      ('ğ”š', 'W'),
      ('ğ”›', 'X'),
      ('ğ”œ', 'Y'),
      ('ğ”', 'a'),
      ('ğ”Ÿ', 'b'),
      ('ğ” ', 'c'),
      ('ğ”¡', 'd'),
      ('ğ”¢', 'e'),
      ('ğ”£', 'f'),
      ('ğ”¤', 'g'),
      ('ğ”¥', 'h'),
      ('ğ”¦', 'i'),
      ('ğ”§', 'j'),
      ('ğ”¨', 'h'),
      ('ğ”©', 'l'),
      ('ğ”ª', 'm'),
      ('ğ”«', 'n'),
      ('ğ”¬', 'o'),
      ('ğ”­', 'p'),
      ('ğ”®', 'q'),
      ('ğ”¯', 'r'),
      ('ğ”°', 's'),
      ('ğ”±', 't'),
      ('ğ”²', 'u'),
      ('ğ”³', 'v'),
      ('ğ”´', 'w'),
      ('ğ”µ', 'x'),
      ('ğ”¶', 'y'),
      ('ğ”·', 'z')
    ]

bbMap :: Map Char Char
bbMap =
  fromList
    [ ('â„‚', 'C'),
      ('â„', 'H'),
      ('â„•', 'N'),
      ('â„™', 'P'),
      ('â„š', 'Q'),
      ('â„', 'R'),
      ('â„¤', 'Z'),
      ('ğ”¸', 'A'),
      ('ğ”¹', 'B'),
      ('ğ”»', 'D'),
      ('ğ”¼', 'E'),
      ('ğ”½', 'F'),
      ('ğ”¾', 'G'),
      ('ğ•€', 'I'),
      ('ğ•', 'J'),
      ('ğ•‚', 'K'),
      ('ğ•ƒ', 'L'),
      ('ğ•„', 'M'),
      ('ğ•†', 'O'),
      ('ğ•Š', 'S'),
      ('ğ•‹', 'T'),
      ('ğ•Œ', 'U'),
      ('ğ•', 'V'),
      ('ğ•', 'W'),
      ('ğ•', 'X'),
      ('ğ•', 'Y'),
      ('ğ•’', 'a'),
      ('ğ•“', 'b'),
      ('ğ•”', 'c'),
      ('ğ••', 'd'),
      ('ğ•–', 'e'),
      ('ğ•—', 'f'),
      ('ğ•˜', 'g'),
      ('ğ•™', 'h'),
      ('ğ•š', 'i'),
      ('ğ•›', 'j'),
      ('ğ•œ', 'k'),
      ('ğ•', 'l'),
      ('ğ•', 'm'),
      ('ğ•Ÿ', 'n'),
      ('ğ• ', 'o'),
      ('ğ•¡', 'p'),
      ('ğ•¢', 'q'),
      ('ğ•£', 'r'),
      ('ğ•¤', 's'),
      ('ğ•¥', 't'),
      ('ğ•¦', 'u'),
      ('ğ•§', 'v'),
      ('ğ•¨', 'w'),
      ('ğ•©', 'x'),
      ('ğ•ª', 'y'),
      ('ğ•«', 'z'),
      ('ğŸ˜', '0'),
      ('ğŸ™', '1'),
      ('ğŸš', '2'),
      ('ğŸ›', '3'),
      ('ğŸœ', '4'),
      ('ğŸ', '5'),
      ('ğŸ', '6'),
      ('ğŸŸ', '7'),
      ('ğŸ ', '8'),
      ('ğŸ¡', '9')
    ]

sfMap :: Map Char Char
sfMap =
  fromList
    [ ('ğŸ¢', '0'),
      ('ğŸ£', '1'),
      ('ğŸ¤', '2'),
      ('ğŸ¥', '3'),
      ('ğŸ¦', '4'),
      ('ğŸ§', '5'),
      ('ğŸ¨', '6'),
      ('ğŸ©', '7'),
      ('ğŸª', '8'),
      ('ğŸ«', '9'),
      ('ğ– ', 'A'),
      ('ğ–¡', 'B'),
      ('ğ–¢', 'C'),
      ('ğ–£', 'D'),
      ('ğ–¤', 'E'),
      ('ğ–¥', 'F'),
      ('ğ–¦', 'G'),
      ('ğ–§', 'H'),
      ('ğ–¨', 'I'),
      ('ğ–©', 'J'),
      ('ğ–ª', 'K'),
      ('ğ–«', 'L'),
      ('ğ–¬', 'M'),
      ('ğ–­', 'N'),
      ('ğ–®', 'O'),
      ('ğ–¯', 'P'),
      ('ğ–°', 'Q'),
      ('ğ–±', 'R'),
      ('ğ–²', 'S'),
      ('ğ–³', 'T'),
      ('ğ–´', 'U'),
      ('ğ–µ', 'V'),
      ('ğ–¶', 'W'),
      ('ğ–·', 'X'),
      ('ğ–¸', 'Y'),
      ('ğ–¹', 'Z'),
      ('ğ–º', 'a'),
      ('ğ–»', 'b'),
      ('ğ–¼', 'c'),
      ('ğ–½', 'd'),
      ('ğ–¾', 'e'),
      ('ğ–¿', 'f'),
      ('ğ—€', 'g'),
      ('ğ—', 'h'),
      ('ğ—‚', 'i'),
      ('ğ—ƒ', 'j'),
      ('ğ—„', 'k'),
      ('ğ—…', 'l'),
      ('ğ—†', 'm'),
      ('ğ—‡', 'n'),
      ('ğ—ˆ', 'o'),
      ('ğ—‰', 'p'),
      ('ğ—Š', 'q'),
      ('ğ—‹', 'r'),
      ('ğ—Œ', 's'),
      ('ğ—', 't'),
      ('ğ—', 'u'),
      ('ğ—', 'v'),
      ('ğ—', 'w'),
      ('ğ—‘', 'x'),
      ('ğ—’', 'y'),
      ('ğ—“', 'z')
    ]

ttMap :: Map Char Char
ttMap =
  fromList
    [ ('ğŸ¶', '0'),
      ('ğŸ·', '1'),
      ('ğŸ¸', '2'),
      ('ğŸ¹', '3'),
      ('ğŸº', '4'),
      ('ğŸ»', '5'),
      ('ğŸ¼', '6'),
      ('ğŸ½', '7'),
      ('ğŸ¾', '8'),
      ('ğŸ¿', '9'),
      ('ğ™°', 'A'),
      ('ğ™±', 'B'),
      ('ğ™²', 'C'),
      ('ğ™³', 'D'),
      ('ğ™´', 'E'),
      ('ğ™µ', 'F'),
      ('ğ™¶', 'G'),
      ('ğ™·', 'H'),
      ('ğ™¸', 'I'),
      ('ğ™¹', 'J'),
      ('ğ™º', 'K'),
      ('ğ™»', 'L'),
      ('ğ™¼', 'M'),
      ('ğ™½', 'N'),
      ('ğ™¾', 'O'),
      ('ğ™¿', 'P'),
      ('ğš€', 'Q'),
      ('ğš', 'R'),
      ('ğš‚', 'S'),
      ('ğšƒ', 'T'),
      ('ğš„', 'U'),
      ('ğš…', 'V'),
      ('ğš†', 'W'),
      ('ğš‡', 'X'),
      ('ğšˆ', 'Y'),
      ('ğš‰', 'Z'),
      ('ğšŠ', 'a'),
      ('ğš‹', 'b'),
      ('ğšŒ', 'c'),
      ('ğš', 'd'),
      ('ğš', 'e'),
      ('ğš', 'f'),
      ('ğš', 'g'),
      ('ğš‘', 'h'),
      ('ğš’', 'i'),
      ('ğš“', 'j'),
      ('ğš”', 'k'),
      ('ğš•', 'l'),
      ('ğš–', 'm'),
      ('ğš—', 'n'),
      ('ğš˜', 'o'),
      ('ğš™', 'p'),
      ('ğšš', 'q'),
      ('ğš›', 'r'),
      ('ğšœ', 's'),
      ('ğš', 't'),
      ('ğš', 'u'),
      ('ğšŸ', 'v'),
      ('ğš ', 'w'),
      ('ğš¡', 'x'),
      ('ğš¢', 'y'),
      ('ğš£', 'z')
    ]

scrMap :: Map Char Char
scrMap =
  fromList
    [ ('ğ’œ', 'A'),
      ('â„¬', 'B'),
      ('ğ’', 'C'),
      ('ğ’Ÿ', 'D'),
      ('â„°', 'E'),
      ('â„±', 'F'),
      ('ğ’¢', 'G'),
      ('â„‹', 'H'),
      ('â„', 'I'),
      ('ğ’¥', 'J'),
      ('ğ’¦', 'K'),
      ('â„’', 'L'),
      ('â„³', 'M'),
      ('ğ’©', 'N'),
      ('ğ’ª', 'O'),
      ('ğ’«', 'P'),
      ('ğ’¬', 'Q'),
      ('â„›', 'R'),
      ('ğ’®', 'S'),
      ('ğ’¯', 'T'),
      ('ğ’°', 'U'),
      ('ğ’±', 'V'),
      ('ğ’²', 'W'),
      ('ğ’³', 'X'),
      ('ğ’´', 'Y'),
      ('ğ’µ', 'Z'),
      ('ğ’¶', 'a'),
      ('ğ’·', 'b'),
      ('ğ’¸', 'c'),
      ('ğ’¹', 'd'),
      ('â„¯', 'e'),
      ('ğ’»', 'f'),
      ('â„Š', 'g'),
      ('ğ’½', 'h'),
      ('ğ’¾', 'i'),
      ('ğ’¿', 'j'),
      ('ğ“€', 'k'),
      ('ğ“', 'l'),
      ('ğ“‚', 'm'),
      ('ğ“ƒ', 'n'),
      ('â„´', 'o'),
      ('ğ“…', 'p'),
      ('ğ“†', 'q'),
      ('ğ“‡', 'r'),
      ('ğ“ˆ', 's'),
      ('ğ“‰', 't'),
      ('ğ“Š', 'u'),
      ('ğ“‹', 'v'),
      ('ğ“Œ', 'w'),
      ('ğ“', 'x'),
      ('ğ“', 'y'),
      ('ğ“', 'z')
    ]
